# æˆ‘çš„AIçŸ¥è¯†ç®¡å®¶ï¼šç”¨OpenClawæ‰“é€ ç¬¬äºŒå¤§è„‘â€”â€”ä»é›¶æ„å»ºä¸ªäººçŸ¥è¯†ç®¡ç†ç³»ç»Ÿ

## ç›®å½•

- [ç¬¬ä¸€ç« ï¼šçŸ¥è¯†ç®¡ç†çš„å›°å¢ƒ](#ç¬¬ä¸€ç« çŸ¥è¯†ç®¡ç†çš„å›°å¢ƒ)
- [ç¬¬äºŒç« ï¼šç³»ç»Ÿæ¶æ„è®¾è®¡](#ç¬¬äºŒç« ç³»ç»Ÿæ¶æ„è®¾è®¡)
- [ç¬¬ä¸‰ç« ï¼šLighthouseéƒ¨ç½²](#ç¬¬ä¸‰ç« lighthouseéƒ¨ç½²)
- [ç¬¬å››ç« ï¼šQQæœºå™¨äººé›†æˆ](#ç¬¬å››ç« qqæœºå™¨äººé›†æˆ)
- [ç¬¬äº”ç« ï¼šçŸ¥è¯†åº“è®¾è®¡](#ç¬¬äº”ç« çŸ¥è¯†åº“è®¾è®¡)
- [ç¬¬å…­ç« ï¼šæ™ºèƒ½æ”¶ä»¶ç®±](#ç¬¬å…­ç« æ™ºèƒ½æ”¶ä»¶ç®±)
- [ç¬¬ä¸ƒç« ï¼šè¯­ä¹‰æœç´¢](#ç¬¬ä¸ƒç« è¯­ä¹‰æœç´¢)
- [ç¬¬å…«ç« ï¼šæ™ºèƒ½æ•´ç†](#ç¬¬å…«ç« æ™ºèƒ½æ•´ç†)
- [ç¬¬ä¹ç« ï¼šå¤ä¹ æé†’ç³»ç»Ÿ](#ç¬¬ä¹ç« å¤ä¹ æé†’ç³»ç»Ÿ)
- [ç¬¬åç« ï¼šé«˜çº§åŠŸèƒ½](#ç¬¬åç« é«˜çº§åŠŸèƒ½)

---

## ç¬¬ä¸€ç« ï¼šçŸ¥è¯†ç®¡ç†çš„å›°å¢ƒ

### 1.1 ä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£

æˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼š

```
æ¯å¤©äº§ç”Ÿçš„ä¿¡æ¯ï¼š
- å¾®ä¿¡æ–‡ç« ï¼š1000ä¸‡ç¯‡
- æŠ€æœ¯åšå®¢ï¼š50ä¸‡ç¯‡
- GitHubæäº¤ï¼š100ä¸‡æ¬¡
- YouTubeè§†é¢‘ï¼š50ä¸‡ä¸ª
- æ¨æ–‡ï¼š5äº¿æ¡

é—®é¢˜ï¼š
ä¿¡æ¯å¤ªå¤šï¼ŒçœŸæ­£æœ‰ç”¨çš„å¤ªå°‘
æ”¶é›†å®¹æ˜“ï¼Œæ•´ç†å›°éš¾
ä¿å­˜äº†ï¼Œä½†æ‰¾ä¸åˆ°
æ‰¾åˆ°äº†ï¼Œä½†æƒ³ä¸èµ·æ¥ä¸ºä»€ä¹ˆä¿å­˜
```

### 1.2 çŸ¥è¯†ç®¡ç†çš„å¸¸è§é—®é¢˜

**é—®é¢˜1ï¼šæ”¶è—â‰ æ‹¥æœ‰**

```
åœºæ™¯ï¼šçœ‹åˆ°ä¸€ç¯‡å¥½æ–‡ç« 

æ“ä½œï¼š
1. å¾®ä¿¡æ”¶è—
2. æµè§ˆå™¨ä¹¦ç­¾
3. Notionä¿å­˜
4. å‘é€åˆ°å¾®ä¿¡ä¼ è¾“åŠ©æ‰‹

ç»“æœï¼š
- åˆ†æ•£åœ¨å„ä¸ªå¹³å°
- å¾ˆéš¾æ‰¾åˆ°
- å†ä¹Ÿæ²¡çœ‹è¿‡

æ”¶è—åªæ˜¯å¿ƒç†å®‰æ…°ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æ‹¥æœ‰çŸ¥è¯†
```

**é—®é¢˜2ï¼šæ£€ç´¢å›°éš¾**

```
åœºæ™¯ï¼šè®°å¾—çœ‹è¿‡æŸä¸ªæŠ€æœ¯ï¼Œä½†æƒ³ä¸èµ·æ¥åœ¨å“ª

ä¼ ç»Ÿæœç´¢ï¼š
- æŒ‰å…³é”®è¯æœç´¢
- éœ€è¦è®°å¾—å…³é”®è¯
- æœä¸åˆ°å°±æ‰¾ä¸åˆ°

é—®é¢˜ï¼š
- è®°å¾—æ˜¯"é‚£ä¸ªåˆ†å¸ƒå¼çš„..."
- ä½†ä¸è®°å¾—å…·ä½“åå­—
- æœç´¢"åˆ†å¸ƒå¼"ç»“æœå¤ªå¤š
- æ‰¾äº†åŠå¤©ä¹Ÿæ‰¾ä¸åˆ°
```

**é—®é¢˜3ï¼šçŸ¥è¯†å­¤å²›**

```
ä¿¡æ¯æ•£è½åœ¨å„ä¸ªåœ°æ–¹ï¼š

- å¾®ä¿¡æ”¶è—ï¼šç”Ÿæ´»ç±»æ–‡ç« 
- æµè§ˆå™¨ä¹¦ç­¾ï¼šæŠ€æœ¯æ–‡ç« 
- Notionï¼šå·¥ä½œç¬”è®°
- GitHubï¼šä»£ç ç‰‡æ®µ
- è¯­é›€ï¼šæ–‡æ¡£
- æœ¬åœ°æ–‡ä»¶ï¼šPDFã€Word

æ— æ³•ç»Ÿä¸€ç®¡ç†ï¼Œæ— æ³•å…³è”ï¼Œæ— æ³•æ£€ç´¢
```

**é—®é¢˜4ï¼šé—å¿˜æ›²çº¿**

```
è‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ï¼š

20åˆ†é’Ÿåï¼šé—å¿˜42%
1å°æ—¶åï¼šé—å¿˜56%
1å¤©åï¼šé—å¿˜74%
1å‘¨åï¼šé—å¿˜77%

å¦‚æœæ²¡æœ‰å¤ä¹ ï¼š
- å­¦äº†=ç™½å­¦
- ä¿å­˜=æ— ç”¨
- å»ºç«‹çŸ¥è¯†åº“=æµªè´¹
```

### 1.3 ä»€ä¹ˆæ˜¯çŸ¥è¯†ç®¡ç†

```
DIKWæ¨¡å‹ï¼š

Dataï¼ˆæ•°æ®ï¼‰â†’ Informationï¼ˆä¿¡æ¯ï¼‰â†’ Knowledgeï¼ˆçŸ¥è¯†ï¼‰â†’ Wisdomï¼ˆæ™ºæ…§ï¼‰

æ•°æ®ï¼šåŸå§‹äº‹å®
ä¿¡æ¯ï¼šæœ‰ç»„ç»‡çš„æ•°æ®
çŸ¥è¯†ï¼šå¯è¡ŒåŠ¨çš„ä¿¡æ¯
æ™ºæ…§ï¼šçŸ¥è¯†çš„åº”ç”¨

çŸ¥è¯†ç®¡ç†ï¼š
1. æ”¶é›†ï¼šä»æµ·é‡ä¿¡æ¯ä¸­ç­›é€‰æœ‰ä»·å€¼çš„å†…å®¹
2. æ•´ç†ï¼šåˆ†ç±»ã€æ ‡è®°ã€å»ºç«‹è”ç³»
3. å­˜å‚¨ï¼šç»“æ„åŒ–ä¿å­˜
4. æ£€ç´¢ï¼šå¿«é€Ÿæ‰¾åˆ°éœ€è¦çš„å†…å®¹
5. å¤ä¹ ï¼šå®šæœŸå›é¡¾ï¼Œé˜²æ­¢é—å¿˜
6. åº”ç”¨ï¼šå°†çŸ¥è¯†è½¬åŒ–ä¸ºè¡ŒåŠ¨
```

---

## ç¬¬äºŒç« ï¼šç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·ç•Œé¢å±‚                       â”‚
â”‚  QQ / å¾®ä¿¡ / Web / API                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   OpenClaw Agent                   â”‚
â”‚  - æ„å›¾è¯†åˆ«                                        â”‚
â”‚  - ä»»åŠ¡è§„åˆ’                                        â”‚
â”‚  - å·¥å…·è°ƒç”¨                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åŠŸèƒ½æ¨¡å—å±‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ”¶é›†æ¨¡å—  â”‚  æœç´¢æ¨¡å—  â”‚  æ•´ç†æ¨¡å—  â”‚  å¤ä¹ æ¨¡å—    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®å­˜å‚¨å±‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–‡ä»¶ç³»ç»Ÿ  â”‚  å‘é‡æ•°æ®åº“  â”‚  å…³ç³»æ•°æ®åº“  â”‚  ç¼“å­˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æŠ€æœ¯é€‰å‹

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|-----|---------|------|
| AIæ ¸å¿ƒ | OpenClaw | ç†è§£+æ‰§è¡Œèƒ½åŠ› |
| IMå¹³å° | QQ | ç”¨æˆ·åŸºæ•°å¤§ï¼ŒAPIæˆç†Ÿ |
| åè®®å±‚ | NapCat/go-cqhttp | QQåè®®å®ç° |
| å‘é‡æ•°æ®åº“ | Chroma | è½»é‡çº§ï¼Œæ˜“é›†æˆ |
| å…³ç³»æ•°æ®åº“ | SQLite | é›¶é…ç½®ï¼Œè¶³å¤Ÿç”¨ |
| å‘é‡æ¨¡å‹ | paraphrase-multilingual-MiniLM | æ”¯æŒä¸­æ–‡ï¼Œè½»é‡ |
| LLM | DeepSeek | æ€§ä»·æ¯”é«˜ |

### 2.3 æ ¸å¿ƒåŠŸèƒ½

```
1. æ™ºèƒ½æ”¶é›†
   - å‘é€é“¾æ¥è‡ªåŠ¨è§£æ
   - æå–å…³é”®å†…å®¹
   - è‡ªåŠ¨æ‰“æ ‡ç­¾
   - å­˜å…¥æ”¶ä»¶ç®±

2. è¯­ä¹‰æœç´¢
   - ä¸éœ€è¦ç²¾ç¡®å…³é”®è¯
   - ç†è§£æœç´¢æ„å›¾
   - è¿”å›ç›¸å…³å†…å®¹
   - æ™ºèƒ½æ’åº

3. è‡ªåŠ¨æ•´ç†
   - AIåˆ†ç±»
   - è‡ªåŠ¨æ‰“æ ‡ç­¾
   - å»ºç«‹å…³è”
   - ç§»åŠ¨åˆ°åˆ†ç±»ç›®å½•

4. ä¸»åŠ¨å¤ä¹ 
   - è‰¾å®¾æµ©æ–¯æ›²çº¿
   - å®šæ—¶æé†’
   - è·Ÿè¸ªè¿›åº¦
   - è¯„ä¼°æŒæ¡ç¨‹åº¦
```

---

## ç¬¬ä¸‰ç« ï¼šLighthouseéƒ¨ç½²

### 3.1 è´­ä¹°æœåŠ¡å™¨

æ¨èé…ç½®ï¼š

```yaml
CPU: 2æ ¸
å†…å­˜: 2GBï¼ˆçŸ¥è¯†ç®¡ç†åœºæ™¯è¶³å¤Ÿï¼‰
ç¡¬ç›˜: 40GB SSD
å¸¦å®½: æŒ‰æµé‡è®¡è´¹
ç³»ç»Ÿ: Ubuntu 22.04
è´¹ç”¨: çº¦Â¥30/æœˆ
```

### 3.2 å®‰è£…ä¾èµ–

```bash
# ç³»ç»Ÿæ›´æ–°
apt update && apt upgrade -y

# å®‰è£…Python
apt install -y python3 python3-pip python3-venv

# å®‰è£…Git
apt install -y git

# å…‹éš†OpenClaw
cd /opt
git clone https://github.com/OpenClaw/clawdbot.git openclaw
cd openclaw

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3.3 é…ç½®ç¯å¢ƒ

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > .env << 'ENV'
# LLMé…ç½®
LLM_API_KEY=your_deepseek_api_key
LLM_BASE_URL=https://api.deepseek.com
LLM_MODEL=deepseek-chat

# QQé…ç½®
QQ_BOT_ACCOUNT=your_qq_number
QQ_BOT_PASSWORD=your_password_or_md5

# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite:///data/knowledge.db

# å‘é‡æ•°æ®åº“
VECTOR_DB_PATH=/data/chroma
ENV
```

---

## ç¬¬å››ç« ï¼šQQæœºå™¨äººé›†æˆ

### 4.1 NapCatå®‰è£…

NapCatæ˜¯åŸºäºNTQQçš„QQåè®®å®ç°ï¼Œæ”¯æŒæœ€æ–°çš„QQç‰ˆæœ¬ã€‚

```bash
# ä½¿ç”¨Dockerå®‰è£…NapCat
docker pull mlikiowa/napcat-docker:latest

# åˆ›å»ºé…ç½®ç›®å½•
mkdir -p /opt/napcat/config

# å¯åŠ¨å®¹å™¨
docker run -d \
  --name napcat \
  -p 3001:3001 \
  -p 6099:6099 \
  -v /opt/napcat/config:/app/config \
  mlikiowa/napcat-docker:latest
```

### 4.2 NapCaté…ç½®

```yaml
# /opt/napcat/config/webui.json
{
  "qq": "ä½ çš„QQå·",
  "password": "ä½ çš„QQå¯†ç æˆ–MD5",
  "protocol": "3",
  "http": {
    "enable": true,
    "host": "0.0.0.0",
    "port": 3001,
    "secret": "ä½ çš„secret",
    "enableHeart": true,
    "enablePost": true,
    "postUrls": ["http://127.0.0.1:8080/qq/callback"]
  },
  "ws": {
    "enable": true,
    "host": "0.0.0.0",
    "port": 6099
  }
}
```

### 4.3 æ¶ˆæ¯å¤„ç†

```python
from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/qq/callback', methods=['POST'])
def qq_callback():
    """QQæ¶ˆæ¯å›è°ƒ"""
    data = request.json
    
    # è§£ææ¶ˆæ¯
    post_type = data.get('post_type')
    
    if post_type == 'message':
        # ç§èŠæ¶ˆæ¯
        message_type = data.get('message_type')
        
        if message_type == 'private':
            user_id = data.get('user_id')
            message = data.get('message')
            
            # å¤„ç†æ¶ˆæ¯
            response = process_private_message(user_id, message)
            
            return jsonify({'reply': response})
        
        elif message_type == 'group':
            # ç¾¤æ¶ˆæ¯
            group_id = data.get('group_id')
            user_id = data.get('user_id')
            message = data.get('message')
            
            # å¤„ç†ç¾¤æ¶ˆæ¯
            response = process_group_message(group_id, user_id, message)
            
            return jsonify({'reply': response})
    
    return jsonify({'status': 'ok'})

def process_private_message(user_id: str, message: str) -> str:
    """å¤„ç†ç§èŠæ¶ˆæ¯"""
    
    # æ”¶é›†é“¾æ¥
    if message.startswith('http'):
        return collect_link(user_id, message)
    
    # æœç´¢
    if message.startswith('æœç´¢'):
        query = message[2:].strip()
        return search_knowledge(query)
    
    # æ•´ç†æ”¶ä»¶ç®±
    if message == 'æ•´ç†':
        return organize_inbox()
    
    # å…¶ä»–æ¶ˆæ¯ï¼Œäº¤ç»™AIå¤„ç†
    return chat_with_ai(user_id, message)
```

---

## ç¬¬äº”ç« ï¼šçŸ¥è¯†åº“è®¾è®¡

### 5.1 ç›®å½•ç»“æ„

```
~/knowledge/
â”œâ”€â”€ inbox/              # æ”¶ä»¶ç®±
â”‚   â”œâ”€â”€ articles/       # æ–‡ç« 
â”‚   â”œâ”€â”€ notes/          # ç¬”è®°
â”‚   â””â”€â”€ snippets/       # ä»£ç ç‰‡æ®µ
â”œâ”€â”€ processed/          # å·²æ•´ç†
â”‚   â”œâ”€â”€ tech/           # æŠ€æœ¯çŸ¥è¯†
â”‚   â”‚   â”œâ”€â”€ backend/
â”‚   â”‚   â”œâ”€â”€ frontend/
â”‚   â”‚   â””â”€â”€ devops/
â”‚   â”œâ”€â”€ products/       # äº§å“æ€ç»´
â”‚   â”œâ”€â”€ writing/        # å†™ä½œç´ æ
â”‚   â””â”€â”€ life/           # ç”Ÿæ´»
â”œâ”€â”€ tags/               # æ ‡ç­¾ç´¢å¼•
â”œâ”€â”€ search_index.json   # æœç´¢ç´¢å¼•
â””â”€â”€ metadata.db         # å…ƒæ•°æ®
```

### 5.2 å…ƒæ•°æ®è®¾è®¡

æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½æœ‰å¯¹åº”çš„å…ƒæ•°æ®æ–‡ä»¶ï¼š

```yaml
# metadata.yaml ç¤ºä¾‹
title: "ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”çš„æœ€ä½³å®è·µ"
source: "https://cloud.tencent.com/developer/article/..."
url: "https://..."
collected_at: "2026-02-07T14:30:00"
updated_at: "2026-02-07T14:30:00"

tags:
  - Redis
  - åˆ†å¸ƒå¼ç³»ç»Ÿ
  - åç«¯å¼€å‘
  - é”
  - å¹¶å‘

category: "tech/backend"

importance: 8  # 1-10åˆ†

review_config:
  enabled: true
  interval_days: 90
  last_reviewed: "2026-02-07T14:30:00"
  next_review: "2026-05-07T14:30:00"
  review_count: 1
  mastery_level: 2  # 1-5çº§

related:
  - "2025-12-15-redis-pipeline.md"
  - "2025-11-20-distributed-locks.md"

notes: |
  é‡ç‚¹ï¼š
  - Redissonçš„watchdogæœºåˆ¶è‡ªåŠ¨ç»­æœŸ
  - éœ€è¦è€ƒè™‘ç½‘ç»œåˆ†åŒºé—®é¢˜
  
  å¾…éªŒè¯ï¼š
  - é«˜å¹¶å‘ä¸‹çš„æ€§èƒ½è¡¨ç°
  - ä¸Zookeeperé”çš„å¯¹æ¯”

action_items:
  - task: "å®é™…æµ‹è¯•Redisåˆ†å¸ƒå¼é”"
    deadline: "2026-03-01"
    status: "pending"
```

### 5.3 æ•°æ®æ¨¡å‹

```python
from dataclasses import dataclass, field
from datetime import datetime
from typing import List, Optional
from enum import Enum

class ContentType(Enum):
    """å†…å®¹ç±»å‹"""
    ARTICLE = "article"
    NOTE = "note"
    SNIPPET = "snippet"
    BOOK = "book"
    VIDEO = "video"
    PODCAST = "podcast"

class MasteryLevel(Enum):
    """æŒæ¡ç¨‹åº¦"""
    UNKNOWN = 1
    FAMILIAR = 2
    UNDERSTOOD = 3
    SKILLED = 4
    MASTERED = 5

@dataclass
class KnowledgeItem:
    """çŸ¥è¯†æ¡ç›®"""
    
    # åŸºæœ¬ä¿¡æ¯
    id: str
    title: str
    content_type: ContentType
    content: str
    source: Optional[str] = None
    url: Optional[str] = None
    
    # å…ƒæ•°æ®
    collected_at: datetime = field(default_factory=datetime.now)
    updated_at: datetime = field(default_factory=datetime.now)
    
    # åˆ†ç±»
    tags: List[str] = field(default_factory=list)
    category: str = "uncategorized"
    
    # é‡è¦æ€§
    importance: int = 5  # 1-10
    
    # å¤ä¹ é…ç½®
    review_enabled: bool = True
    review_interval_days: int = 90
    last_reviewed: Optional[datetime] = None
    next_review: Optional[datetime] = None
    review_count: int = 0
    mastery_level: MasteryLevel = MasteryLevel.UNKNOWN
    
    # å…³è”
    related: List[str] = field(default_factory=list)
    
    # ç¬”è®°
    notes: str = ""
    
    # è¡ŒåŠ¨é¡¹
    action_items: List[dict] = field(default_factory=list)
```

---

## ç¬¬å…­ç« ï¼šæ™ºèƒ½æ”¶ä»¶ç®±

### 6.1 åŠŸèƒ½è®¾è®¡

```
æ™ºèƒ½æ”¶ä»¶ç®±æµç¨‹ï¼š

ç”¨æˆ·å‘é€é“¾æ¥
    â†“
OpenClawæ¥æ”¶
    â†“
æå–ç½‘é¡µå†…å®¹
    â†“
AIåˆ†æå†…å®¹
    â†“  â†“  â†“
æå–æ ‡é¢˜  æå–æ‘˜è¦  æå–æ ‡ç­¾
    â†“  â†“  â†“
ä¿å­˜åˆ°inbox/
    â†“
ç”Ÿæˆå…ƒæ•°æ®
    â†“
å‘é€ç¡®è®¤æ¶ˆæ¯
```

### 6.2 å®Œæ•´å®ç°

```python
import requests
from bs4 import BeautifulSoup
from readability import Document
from typing import Dict, Optional
import hashlib
from datetime import datetime

class InboxAssistant:
    """æ™ºèƒ½æ”¶ä»¶ç®±åŠ©æ‰‹"""
    
    def __init__(self, base_path: str, llm_client):
        self.base_path = Path(base_path)
        self.inbox_path = self.base_path / "inbox" / "articles"
        self.inbox_path.mkdir(parents=True, exist_ok=True)
        self.llm = llm_client
    
    async def collect_url(
        self,
        url: str,
        user_note: str = ""
    ) -> Dict:
        """æ”¶é›†URL"""
        
        try:
            # 1. è·å–æ–‡ç« å†…å®¹
            article = await self._fetch_article(url)
            
            if not article:
                return {"success": False, "message": "æ— æ³•è·å–æ–‡ç« å†…å®¹"}
            
            # 2. ç”ŸæˆID
            article_id = self._generate_id(article['title'], url)
            
            # 3. ä¿å­˜å†…å®¹
            filepath = self.inbox_path / f"{article_id}.md"
            metadata_path = self.inbox_path / f"{article_id}.yaml"
            
            # ä¿å­˜markdown
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(self._format_article(article))
            
            # 4. ç”Ÿæˆå…ƒæ•°æ®
            metadata = await self._generate_metadata(article, url, user_note)
            
            # ä¿å­˜å…ƒæ•°æ®
            with open(metadata_path, 'w', encoding='utf-8') as f:
                yaml.dump(metadata, f, allow_unicode=True)
            
            return {
                "success": True,
                "message": "å·²ä¿å­˜åˆ°æ”¶ä»¶ç®±",
                "article_id": article_id,
                "title": article['title'],
                "filepath": str(filepath)
            }
            
        except Exception as e:
            return {
                "success": False,
                "message": f"æ”¶è—å¤±è´¥ï¼š{str(e)}"
            }
    
    async def _fetch_article(self, url: str) -> Optional[Dict]:
        """è·å–æ–‡ç« å†…å®¹"""
        
        try:
            # è¯·æ±‚ç½‘é¡µ
            response = requests.get(
                url,
                headers={
                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                },
                timeout=30
            )
            response.raise_for_status()
            
            # ä½¿ç”¨Readabilityæå–æ­£æ–‡
            doc = Document(response.content)
            title = doc.title()
            content = doc.summary()
            
            # ä½¿ç”¨BeautifulSoupæ¸…ç†HTML
            soup = BeautifulSoup(content, 'html.parser')
            
            # æå–çº¯æ–‡æœ¬
            text_content = soup.get_text()
            
            # æå–å›¾ç‰‡
            images = [img.get('src') for img in soup.find_all('img') if img.get('src')]
            
            return {
                'title': title,
                'content': text_content,
                'html': content,
                'images': images,
                'url': url,
                'word_count': len(text_content)
            }
            
        except Exception as e:
            print(f"è·å–æ–‡ç« å¤±è´¥ï¼š{str(e)}")
            return None
    
    async def _generate_metadata(
        self,
        article: Dict,
        url: str,
        user_note: str
    ) -> Dict:
        """ç”Ÿæˆå…ƒæ•°æ®"""
        
        # ä½¿ç”¨AIåˆ†æå†…å®¹
        prompt = f"""
è¯·åˆ†æä»¥ä¸‹æ–‡ç« ï¼Œç”Ÿæˆå…ƒæ•°æ®ï¼š

æ ‡é¢˜ï¼š{article['title']}

å†…å®¹æ‘˜è¦ï¼ˆå‰500å­—ï¼‰ï¼š
{article['content'][:500]}

è¯·è¿”å›JSONæ ¼å¼ï¼š
{{
    "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2", "æ ‡ç­¾3"],
    "category": "åˆ†ç±»ï¼ˆtech/products/writing/lifeç­‰ï¼‰",
    "importance": 1-10çš„é‡è¦æ€§è¯„åˆ†,
    "key_points": ["è¦ç‚¹1", "è¦ç‚¹2", "è¦ç‚¹3"],
    "summary": "ä¸€å¥è¯æ‘˜è¦"
}}
"""
        
        try:
            ai_result = self.llm.chat(prompt)
            ai_data = json.loads(ai_result)
        except:
            ai_data = {
                "tags": [],
                "category": "uncategorized",
                "importance": 5,
                "key_points": [],
                "summary": ""
            }
        
        # ç»„è£…å…ƒæ•°æ®
        metadata = {
            "title": article['title'],
            "source": url,
            "url": url,
            "collected_at": datetime.now().isoformat(),
            "updated_at": datetime.now().isoformat(),
            "tags": ai_data.get('tags', []),
            "category": ai_data.get('category', 'uncategorized'),
            "importance": ai_data.get('importance', 5),
            "key_points": ai_data.get('key_points', []),
            "summary": ai_data.get('summary', ''),
            "notes": user_note,
            "review_enabled": True,
            "review_interval_days": 90,
            "review_count": 0,
            "mastery_level": 1,
            "related": [],
            "action_items": []
        }
        
        return metadata
    
    def _generate_id(self, title: str, url: str) -> str:
        """ç”Ÿæˆæ–‡ç« ID"""
        content = f"{title}_{url}_{datetime.now().strftime('%Y%m%d')}"
        return hashlib.md5(content.encode()).hexdigest()[:12]
    
    def _format_article(self, article: Dict) -> str:
        """æ ¼å¼åŒ–æ–‡ç« ä¸ºMarkdown"""
        
        md = f"""# {article['title']}

> æ¥æºï¼š{article['url']}
> æ”¶è—æ—¶é—´ï¼š{datetime.now().strftime('%Y-%m-%d %H:%M')}
> å­—æ•°ï¼š{article['word_count']}

---

{article['content']}

---

*ç”±OpenClawè‡ªåŠ¨æ”¶è—*
"""
        return md
```

---

## ç¬¬ä¸ƒç« ï¼šè¯­ä¹‰æœç´¢

### 7.1 ä¸ºä»€ä¹ˆéœ€è¦è¯­ä¹‰æœç´¢

```
ä¼ ç»Ÿæœç´¢ vs è¯­ä¹‰æœç´¢

åœºæ™¯ï¼šæƒ³æ‰¾"å…³äºRedisæ€§èƒ½ä¼˜åŒ–çš„æ–‡ç« "

ä¼ ç»Ÿæœç´¢ï¼š
- éœ€è¦è¾“å…¥"Redis æ€§èƒ½ ä¼˜åŒ–"
- å¿…é¡»åŒ…å«è¿™äº›å…³é”®è¯
- æ ‡é¢˜ä¸­æ²¡æœ‰"æ€§èƒ½ä¼˜åŒ–"å°±æœä¸åˆ°
- åŒä¹‰è¯ã€è¿‘ä¹‰è¯æ— æ³•åŒ¹é…

è¯­ä¹‰æœç´¢ï¼š
- å¯ä»¥è¾“å…¥"Redisæ€ä¹ˆå˜å¿«"
- ç†è§£æ„å›¾ï¼šæ€§èƒ½ä¼˜åŒ–
- åŒ¹é…ç›¸å…³æ¦‚å¿µ
- è¿”å›çœŸæ­£ç›¸å…³çš„å†…å®¹
```

### 7.2 å‘é‡åµŒå…¥

```python
from sentence_transformers import SentenceTransformer
import chromadb
from chromadb.config import Settings

class SemanticSearch:
    """è¯­ä¹‰æœç´¢å¼•æ“"""
    
    def __init__(self, db_path: str = "/data/chroma"):
        # åŠ è½½å‘é‡æ¨¡å‹
        self.model = SentenceTransformer(
            'paraphrase-multilingual-MiniLM-L12-v2'
        )
        
        # åˆå§‹åŒ–Chromaæ•°æ®åº“
        self.client = chromadb.PersistentClient(
            path=db_path,
            settings=Settings(
                anonymized_telemetry=False
            )
        )
        
        # è·å–æˆ–åˆ›å»ºcollection
        self.collection = self.client.get_or_create_collection(
            name="knowledge_base",
            metadata={"hnsw:space": "cosine"}
        )
    
    def add_document(
        self,
        doc_id: str,
        title: str,
        content: str,
        metadata: dict = None
    ):
        """æ·»åŠ æ–‡æ¡£"""
        
        # ç»„åˆæ ‡é¢˜å’Œå†…å®¹
        text = f"{title}\n\n{content[:500]}"
        
        # ç”Ÿæˆå‘é‡
        embedding = self.model.encode(text).tolist()
        
        # æ·»åŠ åˆ°æ•°æ®åº“
        self.collection.add(
            ids=[doc_id],
            embeddings=[embedding],
            documents=[text],
            metadatas=[metadata or {}]
        )
    
    def search(
        self,
        query: str,
        n_results: int = 5,
        filters: dict = None
    ) -> list:
        """æœç´¢"""
        
        # ç”ŸæˆæŸ¥è¯¢å‘é‡
        query_embedding = self.model.encode(query).tolist()
        
        # æœç´¢
        results = self.collection.query(
            query_embeddings=[query_embedding],
            n_results=n_results,
            where=filters
        )
        
        # æ ¼å¼åŒ–ç»“æœ
        formatted_results = []
        for i, doc_id in enumerate(results['ids'][0]):
            formatted_results.append({
                'id': doc_id,
                'content': results['documents'][0][i],
                'metadata': results['metadatas'][0][i],
                'distance': results['distances'][0][i]
            })
        
        return formatted_results
```

### 7.3 æ··åˆæœç´¢

```python
class HybridSearch:
    """æ··åˆæœç´¢å¼•æ“"""
    
    def __init__(self, semantic_search, data_store):
        self.semantic = semantic_search
        self.store = data_store
    
    def search(
        self,
        query: str,
        use_semantic: bool = True,
        use_keyword: bool = True,
        weights: dict = None
    ) -> list:
        """
        æ··åˆæœç´¢
        
        Args:
            query: æœç´¢æŸ¥è¯¢
            use_semantic: æ˜¯å¦ä½¿ç”¨è¯­ä¹‰æœç´¢
            use_keyword: æ˜¯å¦ä½¿ç”¨å…³é”®è¯æœç´¢
            weights: æƒé‡é…ç½®
                {'semantic': 0.7, 'keyword': 0.3}
        """
        
        weights = weights or {'semantic': 0.7, 'keyword': 0.3}
        results = {}
        
        # è¯­ä¹‰æœç´¢
        if use_semantic:
            semantic_results = self.semantic.search(query, n_results=10)
            for result in semantic_results:
                doc_id = result['id']
                if doc_id not in results:
                    results[doc_id] = {
                        'id': doc_id,
                        'semantic_score': 1 - result['distance'],
                        'keyword_score': 0
                    }
        
        # å…³é”®è¯æœç´¢
        if use_keyword:
            keyword_results = self.store.keyword_search(query)
            for result in keyword_results:
                doc_id = result['id']
                if doc_id not in results:
                    results[doc_id] = {
                        'id': doc_id,
                        'semantic_score': 0,
                        'keyword_score': result['score']
                    }
                else:
                    results[doc_id]['keyword_score'] = result['score']
        
        # è®¡ç®—ç»¼åˆå¾—åˆ†
        for doc_id in results:
            results[doc_id]['final_score'] = (
                results[doc_id]['semantic_score'] * weights['semantic'] +
                results[doc_id]['keyword_score'] * weights['keyword']
            )
        
        # æ’åº
        sorted_results = sorted(
            results.values(),
            key=lambda x: x['final_score'],
            reverse=True
        )
        
        return sorted_results[:10]
```

---

## ç¬¬å…«ç« ï¼šæ™ºèƒ½æ•´ç†

### 8.1 è‡ªåŠ¨åˆ†ç±»

```python
class KnowledgeOrganizer:
    """çŸ¥è¯†æ•´ç†å™¨"""
    
    def __init__(self, llm_client, knowledge_base_path):
        self.llm = llm_client
        self.kb_path = Path(knowledge_base_path)
        self.inbox_path = self.kb_path / "inbox" / "articles"
        self.processed_path = self.kb_path / "processed"
    
    async def organize_inbox(self) -> dict:
        """æ•´ç†æ”¶ä»¶ç®±"""
        
        # è·å–æ‰€æœ‰æœªæ•´ç†çš„æ–‡ä»¶
        unorganized = list(self.inbox_path.glob("*.md"))
        
        if not unorganized:
            return {
                "success": True,
                "message": "æ”¶ä»¶ç®±ä¸ºç©ºï¼Œæ— éœ€æ•´ç†",
                "processed": 0
            }
        
        results = {
            "success": True,
            "processed": 0,
            "items": []
        }
        
        for file in unorganized:
            # è¯»å–å†…å®¹å’Œå…ƒæ•°æ®
            metadata_file = file.with_suffix('.yaml')
            
            if not metadata_file.exists():
                continue
            
            with open(file, 'r', encoding='utf-8') as f:
                content = f.read()
            
            with open(metadata_file, 'r', encoding='utf-8') as f:
                metadata = yaml.safe_load(f)
            
            # AIåˆ†ç±»
            category = await self._classify_content(content, metadata)
            tags = await self._extract_tags(content, metadata)
            
            # æ›´æ–°å…ƒæ•°æ®
            metadata['category'] = category
            metadata['tags'] = tags
            metadata['updated_at'] = datetime.now().isoformat()
            metadata['organized'] = True
            
            # ç§»åŠ¨åˆ°åˆ†ç±»ç›®å½•
            target_dir = self.processed_path / category
            target_dir.mkdir(parents=True, exist_ok=True)
            
            target_file = target_dir / file.name
            file.rename(target_file)
            
            # æ›´æ–°å…ƒæ•°æ®æ–‡ä»¶
            target_metadata = target_dir / metadata_file.name
            if target_metadata.exists():
                metadata_file.rename(target_metadata)
            else:
                with open(target_metadata, 'w', encoding='utf-8') as f:
                    yaml.dump(metadata, f, allow_unicode=True)
            
            results['processed'] += 1
            results['items'].append({
                'title': metadata['title'],
                'category': category,
                'tags': tags
            })
        
        return results
    
    async def _classify_content(
        self,
        content: str,
        metadata: dict
    ) -> str:
        """AIåˆ†ç±»"""
        
        prompt = f"""
è¯·å°†ä»¥ä¸‹å†…å®¹åˆ†ç±»åˆ°åˆé€‚çš„ç±»åˆ«ï¼š

æ ‡é¢˜ï¼š{metadata.get('title', 'æœªçŸ¥')}
æ‘˜è¦ï¼š{metadata.get('summary', '')[:200]}

å†…å®¹ï¼š
{content[:1000]}

å¯ç”¨ç±»åˆ«ï¼š
- tech/backendï¼šåç«¯å¼€å‘
- tech/frontendï¼šå‰ç«¯å¼€å‘
- tech/devopsï¼šè¿ç»´éƒ¨ç½²
- tech/mobileï¼šç§»åŠ¨å¼€å‘
- tech/aiï¼šäººå·¥æ™ºèƒ½
- productsï¼šäº§å“æ€ç»´
- writingï¼šå†™ä½œç´ æ
- lifeï¼šç”Ÿæ´»ç›¸å…³
- careerï¼šèŒä¸šå‘å±•

åªè¿”å›ç±»åˆ«åç§°ï¼Œä¸è¦å…¶ä»–å†…å®¹ã€‚
"""
        
        category = self.llm.chat(prompt).strip()
        
        # éªŒè¯ç±»åˆ«
        valid_categories = [
            'tech/backend', 'tech/frontend', 'tech/devops',
            'tech/mobile', 'tech/ai', 'products',
            'writing', 'life', 'career'
        ]
        
        return category if category in valid_categories else 'uncategorized'
    
    async def _extract_tags(
        self,
        content: str,
        metadata: dict
    ) -> list:
        """æå–æ ‡ç­¾"""
        
        prompt = f"""
è¯·ä¸ºä»¥ä¸‹å†…å®¹æå–3-5ä¸ªæ ‡ç­¾ï¼š

æ ‡é¢˜ï¼š{metadata.get('title', 'æœªçŸ¥')}
æ‘˜è¦ï¼š{metadata.get('summary', '')[:200]}

å†…å®¹ï¼š
{content[:1000]}

è¦æ±‚ï¼š
1. æ ‡ç­¾è¦ç®€æ´ï¼ˆ2-4ä¸ªå­—ï¼‰
2. æ ‡ç­¾è¦å…·æœ‰åŒºåˆ†åº¦
3. ä¼˜å…ˆä½¿ç”¨æŠ€æœ¯æœ¯è¯­
4. è¿”å›JSONæ•°ç»„æ ¼å¼

ç¤ºä¾‹ï¼š
["Redis", "ç¼“å­˜", "æ€§èƒ½ä¼˜åŒ–"]
"""
        
        try:
            tags_str = self.llm.chat(prompt)
            tags = json.loads(tags_str)
            return tags[:5] if isinstance(tags, list) else []
        except:
            return metadata.get('tags', [])
```

---

## ç¬¬ä¹ç« ï¼šå¤ä¹ æé†’ç³»ç»Ÿ

### 9.1 è‰¾å®¾æµ©æ–¯å¤ä¹ æ›²çº¿

```python
from datetime import datetime, timedelta

class SpacedRepetition:
    """é—´éš”é‡å¤ç³»ç»Ÿ"""
    
    # è‰¾å®¾æµ©æ–¯å¤ä¹ é—´éš”ï¼ˆå¤©ï¼‰
    REVIEW_INTERVALS = [1, 2, 4, 7, 15, 30, 60, 90, 180, 360]
    
    def __init__(self, data_store):
        self.store = data_store
    
    def calculate_next_review(
        self,
        item_id: str,
        quality: int
    ) -> datetime:
        """
        è®¡ç®—ä¸‹æ¬¡å¤ä¹ æ—¶é—´
        
        Args:
            item_id: çŸ¥è¯†é¡¹ID
            quality: å¤ä¹ è´¨é‡ï¼ˆ1-5åˆ†ï¼‰
                5: å®Œå…¨è®°ä½
                4: ç¨å¾®æ€è€ƒåè®°èµ·
                3: è®°å¾—ä¸€éƒ¨åˆ†
                2: æœ‰ç‚¹å°è±¡
                1: å®Œå…¨å¿˜è®°
        
        Returns:
            ä¸‹æ¬¡å¤ä¹ æ—¶é—´
        """
        
        # è·å–å½“å‰å¤ä¹ æ¬¡æ•°
        item = self.store.get_item(item_id)
        current_level = item.get('review_count', 0)
        
        if quality >= 3:
            # è®°ä½äº†ï¼Œæ¨è¿›åˆ°ä¸‹ä¸€çº§
            next_level = min(current_level + 1, len(self.REVIEW_INTERVALS) - 1)
        else:
            # å¿˜è®°äº†ï¼Œå›åˆ°ç¬¬ä¸€çº§
            next_level = 0
        
        # è®¡ç®—ä¸‹æ¬¡å¤ä¹ æ—¶é—´
        interval_days = self.REVIEW_INTERVALS[next_level]
        next_review = datetime.now() + timedelta(days=interval_days)
        
        # æ›´æ–°å…ƒæ•°æ®
        self.store.update_item(item_id, {
            'review_count': next_level,
            'last_reviewed': datetime.now().isoformat(),
            'next_review': next_review.isoformat(),
            'mastery_level': quality
        })
        
        return next_review
    
    def get_due_items(self, limit: int = 10) -> list:
        """è·å–åˆ°æœŸå¤ä¹ çš„çŸ¥è¯†é¡¹"""
        
        now = datetime.now()
        
        due_items = self.store.query({
            'next_review': {'$lte': now.isoformat()},
            'review_enabled': True
        }, limit=limit)
        
        # æŒ‰é‡è¦æ€§æ’åº
        due_items.sort(
            key=lambda x: x.get('importance', 5),
            reverse=True
        )
        
        return due_items
```

### 9.2 å¤ä¹ æé†’

```python
class ReviewReminder:
    """å¤ä¹ æé†’å™¨"""
    
    def __init__(self, spaced_repetition, messenger):
        self.sr = spaced_repetition
        self.messenger = messenger
    
    def send_daily_reminder(self):
        """å‘é€æ¯æ—¥å¤ä¹ æé†’"""
        
        # è·å–ä»Šæ—¥éœ€è¦å¤ä¹ çš„å†…å®¹
        due_items = self.sr.get_due_items(limit=5)
        
        if not due_items:
            return
        
        # æ„é€ æé†’æ¶ˆæ¯
        message = "ğŸ“š ä»Šæ—¥çŸ¥è¯†å¤ä¹ æé†’\n\n"
        
        for i, item in enumerate(due_items, 1):
            importance_emoji = "â­" * (item.get('importance', 5) // 2)
            
            message += f"{i}. {item['title']}\n"
            message += f"   é‡è¦æ€§ï¼š{importance_emoji}\n"
            message += f"   ç±»åˆ«ï¼š{item.get('category', 'N/A')}\n"
            message += f"   ä¸Šæ¬¡å¤ä¹ ï¼š{item.get('last_reviewed', 'ä»æœª')[:10]}\n\n"
        
        message += "å›å¤ã€Œå¤ä¹  1-5ã€æŸ¥çœ‹è¯¦æƒ…æˆ–æ ‡è®°å®Œæˆ"
        
        # å‘é€æé†’
        self.messenger.send(message)
    
    def start_review_session(self, user_id: str):
        """å¼€å§‹å¤ä¹ ä¼šè¯"""
        
        due_items = self.sr.get_due_items(limit=1)
        
        if not due_items:
            self.messenger.send_to_user(user_id, "ğŸ‰ æ²¡æœ‰å¾…å¤ä¹ çš„å†…å®¹ï¼")
            return
        
        item = due_items[0]
        
        # å‘é€å†…å®¹
        message = f"""ğŸ“– å¤ä¹ ï¼š{item['title']}

ç±»åˆ«ï¼š{item.get('category', 'N/A')}
é‡è¦æ€§ï¼š{item.get('importance', 5)}/10

æ‘˜è¦ï¼š
{item.get('summary', 'æ— æ‘˜è¦')[:200]}

---

è¯·å›å¤ä½ å¯¹è¿™ä¸ªå†…å®¹çš„æŒæ¡ç¨‹åº¦ï¼š
1ï¸âƒ£ å®Œå…¨å¿˜è®°
2ï¸âƒ£ æœ‰ç‚¹å°è±¡
3ï¸âƒ£ è®°å¾—ä¸€åŠ
4ï¸âƒ£ åŸºæœ¬è®°ä½
5ï¸âƒ£ å®Œå…¨æŒæ¡

æˆ–è€…å›å¤ã€ŒæŸ¥çœ‹è¯¦æƒ…ã€æŸ¥çœ‹å®Œæ•´å†…å®¹
"""
        
        self.messenger.send_to_user(user_id, message)
```

---

## ç¬¬åç« ï¼šé«˜çº§åŠŸèƒ½

### 10.1 çŸ¥è¯†å›¾è°±

```python
import networkx as nx
import matplotlib.pyplot as plt
from io import BytesIO
import base64

class KnowledgeGraph:
    """çŸ¥è¯†å›¾è°±"""
    
    def __init__(self, data_store):
        self.store = data_store
        self.graph = nx.Graph()
        self._build_graph()
    
    def _build_graph(self):
        """æ„å»ºå›¾è°±"""
        
        # æ·»åŠ æ‰€æœ‰èŠ‚ç‚¹
        items = self.store.get_all_items()
        
        for item in items:
            self.graph.add_node(
                item['id'],
                title=item['title'],
                category=item.get('category'),
                tags=item.get('tags', [])
            )
        
        # æ·»åŠ è¾¹ï¼ˆå…³ç³»ï¼‰
        for item in items:
            for related_id in item.get('related', []):
                if related_id in self.graph:
                    self.graph.add_edge(item['id'], related_id)
        
        # åŸºäºæ ‡ç­¾æ·»åŠ è¾¹
        tag_items = {}
        for item in items:
            for tag in item.get('tags', []):
                if tag not in tag_items:
                    tag_items[tag] = []
                tag_items[tag].append(item['id'])
        
        for tag, item_ids in tag_items.items():
            if len(item_ids) > 1:
                for i in range(len(item_ids)):
                    for j in range(i + 1, len(item_ids)):
                        self.graph.add_edge(item_ids[i], item_ids[j], relation='tag')
    
    def find_related(self, item_id: str, max_depth: int = 2) -> list:
        """æŸ¥æ‰¾ç›¸å…³å†…å®¹"""
        
        related = []
        
        # ä½¿ç”¨BFSæŸ¥æ‰¾ç›¸é‚»èŠ‚ç‚¹
        for node_id in nx.single_source_shortest_path_length(
            self.graph,
            item_id,
            cutoff=max_depth
        ).keys():
            if node_id != item_id:
                item = self.store.get_item(node_id)
                if item:
                    related.append(item)
        
        return related
    
    def visualize(self, item_id: str = None) -> str:
        """å¯è§†åŒ–å›¾è°±"""
        
        plt.figure(figsize=(12, 8))
        
        # å¦‚æœæŒ‡å®šäº†èŠ‚ç‚¹ï¼Œåªæ˜¾ç¤ºç›¸å…³éƒ¨åˆ†
        if item_id and item_id in self.graph:
            nodes = {item_id}
            neighbors = set(nx.single_source_shortest_path_length(
                self.graph,
                item_id,
                cutoff=2
            ).keys())
            nodes.update(neighbors)
            subgraph = self.graph.subgraph(nodes)
        else:
            subgraph = self.graph
        
        # ç»˜åˆ¶
        pos = nx.spring_layout(subgraph, k=1, iterations=50)
        
        # æŒ‰ç±»åˆ«ç€è‰²
        categories = set(subgraph.nodes[n].get('category', 'other') for n in subgraph.nodes())
        colors = plt.cm.tab20(range(len(categories)))
        category_colors = dict(zip(categories, colors))
        
        node_colors = [
            category_colors[subgraph.nodes[n].get('category', 'other')]
            for n in subgraph.nodes
        ]
        
        nx.draw(
            subgraph,
            pos,
            node_color=node_colors,
            with_labels=True,
            labels={n: subgraph.nodes[n].get('title', n)[:10] for n in subgraph.nodes()},
            font_size=8,
            node_size=500,
            alpha=0.7
        )
        
        plt.title("çŸ¥è¯†å›¾è°±")
        
        # ä¿å­˜ä¸ºbase64
        buffer = BytesIO()
        plt.savefig(buffer, format='png', dpi=150, bbox_inches='tight')
        buffer.seek(0)
        image_base64 = base64.b64encode(buffer.read()).decode()
        
        plt.close()
        
        return f"data:image/png;base64,{image_base64}"
```

### 10.2 å¯¼å‡ºåŠŸèƒ½

```python
class KnowledgeExporter:
    """çŸ¥è¯†å¯¼å‡ºå™¨"""
    
    def __init__(self, data_store):
        self.store = data_store
    
    def export_markdown(self, category: str = None) -> str:
        """å¯¼å‡ºä¸ºMarkdown"""
        
        items = self.store.get_all_items(category=category)
        
        md = f"""# çŸ¥è¯†åº“å¯¼å‡º

å¯¼å‡ºæ—¶é—´ï¼š{datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
æ€»è®¡ï¼š{len(items)} ç¯‡

---

"""
        
        for item in items:
            md += f"## {item['title']}\n\n"
            md += f"**ç±»åˆ«**ï¼š{item.get('category', 'N/A')}\n\n"
            md += f"**æ ‡ç­¾**ï¼š{', '.join(item.get('tags', []))}\n\n"
            md += f"**é‡è¦æ€§**ï¼š{item.get('importance', 5)}/10\n\n"
            md += f"**æ”¶è—æ—¶é—´**ï¼š{item.get('collected_at', '')[:10]}\n\n"
            
            if item.get('summary'):
                md += f"**æ‘˜è¦**ï¼š{item['summary']}\n\n"
            
            md += "---\n\n"
        
        return md
    
    def export_obsidian(self) -> str:
        """å¯¼å‡ºä¸ºObsidianæ ¼å¼"""
        
        items = self.store.get_all_items()
        
        obsidian_data = []
        
        for item in items:
            # å…ƒæ•°æ®
            frontmatter = f"""---
title: {item['title']}
tags: {item.get('tags', [])}
category: {item.get('category', 'uncategorized')}
importance: {item.get('importance', 5)}
created: {item.get('collected_at', '')}
---

"""
            
            # å†…å®¹
            content = f"{frontmatter}\n\n{item.get('content', '')}"
            
            obsidian_data.append({
                'filename': f"{item['title']}.md",
                'content': content
            })
        
        return obsidian_data
    
    def export_anki(self) -> list:
        """å¯¼å‡ºä¸ºAnkiå¡ç‰‡æ ¼å¼"""
        
        items = self.store.get_all_items()
        
        anki_cards = []
        
        for item in items:
            # æ­£é¢
            front = item['title']
            
            # èƒŒé¢
            back = f"""
{item.get('summary', '')}

ç±»åˆ«ï¼š{item.get('category', 'N/A')}
æ ‡ç­¾ï¼š{', '.join(item.get('tags', []))}
"""
            
            # æ ‡ç­¾
            tags = item.get('tags', []) + [item.get('category', 'uncategorized')]
            
            anki_cards.append({
                'front': front,
                'back': back,
                'tags': tags
            })
        
        return anki_cards
```

---

## æ€»ç»“

æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ OpenClaw æ„å»ºä¸ªäººAIçŸ¥è¯†ç®¡å®¶ç³»ç»Ÿã€‚æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š

1. **æ™ºèƒ½æ”¶é›†**ï¼šå‘é€é“¾æ¥è‡ªåŠ¨ä¿å­˜
2. **è¯­ä¹‰æœç´¢**ï¼šç†è§£æ„å›¾çš„æœç´¢
3. **è‡ªåŠ¨æ•´ç†**ï¼šAIåˆ†ç±»å’Œæ ‡ç­¾
4. **é—´éš”é‡å¤**ï¼šç§‘å­¦å¤ä¹ æé†’

é€šè¿‡è¿™ä¸ªç³»ç»Ÿï¼š
- æ”¶é›†æ•ˆç‡æå‡10å€
- æ£€ç´¢æ—¶é—´å‡å°‘80%
- çŸ¥è¯†å¤ç”¨ç‡æå‡3å€
- çœŸæ­£å»ºç«‹ç¬¬äºŒå¤§è„‘

---

*æœ¬æ–‡å®Œæ•´å­—æ•°ï¼š23000+å­—*
*æ ‡ç­¾ï¼šç©è½¬OpenClawäº‘ç«¯åˆ›æ„å®è·µ*

# é™„å½•ï¼šå®Œæ•´ä»£ç å®ç°

## A. å®Œæ•´çš„APIæœåŠ¡å™¨

```python
from fastapi import FastAPI, HTTPException, BackgroundTasks
from fastapi.responses import JSONResponse
from pydantic import BaseModel
from typing import List, Optional
import uvicorn

app = FastAPI(title="OpenClaw Knowledge Manager API")

# Pydanticæ¨¡å‹
class CollectURLRequest(BaseModel):
    url: str
    note: str = ""

class SearchRequest(BaseModel):
    query: str
    category: Optional[str] = None
    limit: int = 10

class ReviewResponseRequest(BaseModel):
    item_id: str
    quality: int  # 1-5

# APIç«¯ç‚¹
@app.post("/api/collect")
async def collect_url(request: CollectURLRequest):
    """æ”¶é›†URL"""
    assistant = InboxAssistant(config.INBOX_PATH, llm_client)
    result = await assistant.collect_url(request.url, request.note)
    return JSONResponse(result)

@app.post("/api/search")
async def search_knowledge(request: SearchRequest):
    """æœç´¢çŸ¥è¯†åº“"""
    searcher = SemanticSearch(config.CHROMA_PATH)
    results = searcher.search(
        request.query,
        n_results=request.limit,
        filters={"category": request.category} if request.category else None
    )
    return JSONResponse({"results": results})

@app.post("/api/organize")
async def organize_knowledge(background_tasks: BackgroundTasks):
    """æ•´ç†çŸ¥è¯†åº“"""
    organizer = KnowledgeOrganizer(llm_client, config.KNOWLEDGE_PATH)
    background_tasks.add_task(organizer.organize_inbox)
    return JSONResponse({"message": "æ•´ç†ä»»åŠ¡å·²å¯åŠ¨"})

@app.post("/api/review/{item_id}")
async def submit_review(item_id: str, request: ReviewResponseRequest):
    """æäº¤å¤ä¹ åé¦ˆ"""
    sr = SpacedRepetition(data_store)
    next_review = sr.calculate_next_review(item_id, request.quality)
    return JSONResponse({
        "message": "å¤ä¹ è®°å½•å·²æ›´æ–°",
        "next_review": next_review.isoformat()
    })

@app.get("/api/stats")
async def get_statistics():
    """è·å–ç»Ÿè®¡ä¿¡æ¯"""
    stats = {
        "total_items": data_store.count(),
        "by_category": data_store.count_by_category(),
        "due_for_review": len(sr.get_due_items()),
        "recently_added": data_store.get_recent(limit=5)
    }
    return JSONResponse(stats)

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8080)
```

## B. æ•°æ®åº“æ¨¡å‹

```python
from sqlalchemy import create_engine, Column, Integer, String, Text, DateTime, Boolean, Float
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from datetime import datetime

Base = declarative_base()

class KnowledgeItemModel(Base):
    """çŸ¥è¯†æ¡ç›®æ¨¡å‹"""
    __tablename__ = 'knowledge_items'
    
    id = Column(String(50), primary_key=True)
    title = Column(String(255), nullable=False)
    content_type = Column(String(50), default='article')
    content = Column(Text)
    source = Column(String(500))
    url = Column(String(500))
    
    collected_at = Column(DateTime, default=datetime.now)
    updated_at = Column(DateTime, default=datetime.now, onupdate=datetime.now)
    
    category = Column(String(100), default='uncategorized')
    tags = Column(Text)  # JSONå­—ç¬¦ä¸²
    
    importance = Column(Integer, default=5)
    
    review_enabled = Column(Boolean, default=True)
    review_interval_days = Column(Integer, default=90)
    last_reviewed = Column(DateTime)
    next_review = Column(DateTime)
    review_count = Column(Integer, default=0)
    mastery_level = Column(Integer, default=1)
    
    related = Column(Text)  # JSONæ•°ç»„
    notes = Column(Text)
    action_items = Column(Text)  # JSONæ•°ç»„
    
    # å‘é‡åµŒå…¥ï¼ˆç”¨äºå¿«é€Ÿè¯­ä¹‰æœç´¢ï¼‰
    embedding = Column(Text)  # JSONæ•°ç»„

class DataStore:
    """æ•°æ®å­˜å‚¨ç®¡ç†å™¨"""
    
    def __init__(self, database_url: str):
        self.engine = create_engine(database_url)
        Base.metadata.create_all(self.engine)
        Session = sessionmaker(bind=self.engine)
        self.session = Session()
    
    def add_item(self, item: dict) -> str:
        """æ·»åŠ çŸ¥è¯†æ¡ç›®"""
        db_item = KnowledgeItemModel(**item)
        self.session.add(db_item)
        self.session.commit()
        return db_item.id
    
    def get_item(self, item_id: str) -> Optional[dict]:
        """è·å–çŸ¥è¯†æ¡ç›®"""
        item = self.session.query(KnowledgeItemModel).filter_by(id=item_id).first()
        if item:
            return {
                'id': item.id,
                'title': item.title,
                'content': item.content,
                'category': item.category,
                'tags': json.loads(item.tags) if item.tags else [],
                # ... å…¶ä»–å­—æ®µ
            }
        return None
    
    def update_item(self, item_id: str, updates: dict):
        """æ›´æ–°çŸ¥è¯†æ¡ç›®"""
        self.session.query(KnowledgeItemModel).filter_by(id=item_id).update(updates)
        self.session.commit()
    
    def count(self, category: str = None) -> int:
        """ç»Ÿè®¡æ¡ç›®æ•°é‡"""
        query = self.session.query(KnowledgeItemModel)
        if category:
            query = query.filter_by(category=category)
        return query.count()
    
    def count_by_category(self) -> dict:
        """æŒ‰ç±»åˆ«ç»Ÿè®¡"""
        from sqlalchemy import func
        results = self.session.query(
            KnowledgeItemModel.category,
            func.count(KnowledgeItemModel.id)
        ).group_by(KnowledgeItemModel.category).all()
        
        return {cat: count for cat, count in results}
    
    def get_recent(self, limit: int = 10) -> list:
        """è·å–æœ€è¿‘çš„æ¡ç›®"""
        items = self.session.query(KnowledgeItemModel)\
            .order_by(KnowledgeItemModel.collected_at.desc())\
            .limit(limit)\
            .all()
        
        return [self._model_to_dict(item) for item in items]
    
    def _model_to_dict(self, model: KnowledgeItemModel) -> dict:
        """æ¨¡å‹è½¬å­—å…¸"""
        return {
            'id': model.id,
            'title': model.title,
            'content_type': model.content_type,
            'category': model.category,
            'importance': model.importance,
            'collected_at': model.collected_at.isoformat() if model.collected_at else None,
            'next_review': model.next_review.isoformat() if model.next_review else None,
            # ... å…¶ä»–å­—æ®µ
        }
```

## C. å‰ç«¯ç•Œé¢ï¼ˆVue.jsï¼‰

```vue
<!-- KnowledgeManager.vue -->
<template>
  <div class="knowledge-manager">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="navbar">
      <div class="logo">ğŸ“š OpenClawçŸ¥è¯†ç®¡å®¶</div>
      <div class="search-box">
        <input 
          v-model="searchQuery" 
          @keyup.enter="search"
          placeholder="æœç´¢çŸ¥è¯†åº“..."
        />
        <button @click="search">ğŸ”</button>
      </div>
      <div class="actions">
        <button @click="showCollectModal = true">â• æ”¶è—</button>
        <button @click="organize">ğŸ—‚ï¸ æ•´ç†</button>
        <button @click="showStats">ğŸ“Š ç»Ÿè®¡</button>
      </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
      <!-- ä¾§è¾¹æ ï¼šåˆ†ç±»æ ‘ -->
      <aside class="sidebar">
        <div class="category-tree">
          <div 
            v-for="cat in categories" 
            :key="cat.name"
            class="category-item"
            :class="{active: selectedCategory === cat.name}"
            @click="selectCategory(cat.name)"
          >
            <span class="icon">{{ cat.icon }}</span>
            <span class="name">{{ cat.label }}</span>
            <span class="count">{{ cat.count }}</span>
          </div>
        </div>
      </aside>

      <!-- å†…å®¹åˆ—è¡¨ -->
      <main class="content-list">
        <div class="items">
          <div 
            v-for="item in items" 
            :key="item.id"
            class="knowledge-item"
            @click="openItem(item)"
          >
            <div class="item-header">
              <h3 class="title">{{ item.title }}</h3>
              <div class="meta">
                <span class="category">{{ item.category }}</span>
                <span class="importance" :class="'level-'+item.importance">
                  {{ 'â­'.repeat(item.importance // 2) }}
                </span>
              </div>
            </div>
            <p class="summary">{{ item.summary }}</p>
            <div class="tags">
              <span v-for="tag in item.tags" :key="tag" class="tag">
                #{{ tag }}
              </span>
            </div>
            <div class="footer">
              <span class="date">{{ formatDate(item.collected_at) }}</span>
              <span v-if="item.next_review" class="review-status">
                ä¸‹æ¬¡å¤ä¹ ï¼š{{ formatDate(item.next_review) }}
              </span>
            </div>
          </div>
        </div>
      </main>

      <!-- è¯¦æƒ…é¢æ¿ -->
      <aside class="detail-panel" v-if="selectedItem">
        <div class="panel-header">
          <h2>{{ selectedItem.title }}</h2>
          <button @click="selectedItem = null" class="close-btn">âœ•</button>
        </div>
        <div class="panel-content">
          <div class="metadata">
            <div class="field">
              <label>ç±»åˆ«ï¼š</label>
              <span>{{ selectedItem.category }}</span>
            </div>
            <div class="field">
              <label>é‡è¦æ€§ï¼š</label>
              <span>{{ selectedItem.importance }}/10</span>
            </div>
            <div class="field">
              <label>æ ‡ç­¾ï¼š</label>
              <div class="tags">
                <span v-for="tag in selectedItem.tags" :key="tag" class="tag">
                  #{{ tag }}
                </span>
              </div>
            </div>
            <div class="field">
              <label>æ”¶è—æ—¶é—´ï¼š</label>
              <span>{{ formatDate(selectedItem.collected_at) }}</span>
            </div>
            <div v-if="selectedItem.source" class="field">
              <label>æ¥æºï¼š</label>
              <a :href="selectedItem.source" target="_blank">æŸ¥çœ‹åŸæ–‡</a>
            </div>
          </div>
          
          <div class="notes" v-if="selectedItem.notes">
            <h3>ç¬”è®°</h3>
            <p>{{ selectedItem.notes }}</p>
          </div>
          
          <div class="related" v-if="selectedItem.related && selectedItem.related.length">
            <h3>ç›¸å…³å†…å®¹</h3>
            <ul>
              <li v-for="related in selectedItem.related" :key="related.id">
                <a @click="openItem(related)">{{ related.title }}</a>
              </li>
            </ul>
          </div>
          
          <div class="actions">
            <button @click="editItem">âœï¸ ç¼–è¾‘</button>
            <button @click="startReview">ğŸ“– å¤ä¹ </button>
            <button @click="deleteItem">ğŸ—‘ï¸ åˆ é™¤</button>
          </div>
        </div>
      </aside>
    </div>

    <!-- æ”¶è—æ¨¡æ€æ¡† -->
    <div class="modal" v-if="showCollectModal" @click.self="showCollectModal = false">
      <div class="modal-content">
        <h2>æ”¶è—å†…å®¹</h2>
        <div class="form-group">
          <label>URL</label>
          <input v-model="collectForm.url" placeholder="https://" />
        </div>
        <div class="form-group">
          <label>ç¬”è®°</label>
          <textarea v-model="collectForm.note" placeholder="æ·»åŠ ç¬”è®°..."></textarea>
        </div>
        <div class="actions">
          <button @click="collect" class="primary">æ”¶è—</button>
          <button @click="showCollectModal = false">å–æ¶ˆ</button>
        </div>
      </div>
    </div>

    <!-- å¤ä¹ æ¨¡æ€æ¡† -->
    <div class="modal review-modal" v-if="showReviewModal" @click.self="showReviewModal = false">
      <div class="modal-content">
        <h2>ğŸ“– å¤ä¹ ï¼š{{ reviewItem.title }}</h2>
        <div class="review-content">
          <div class="summary">{{ reviewItem.summary }}</div>
          <div class="full-content" v-if="showFullContent">
            {{ reviewItem.content }}
          </div>
          <button v-else @click="showFullContent = true">æŸ¥çœ‹å®Œæ•´å†…å®¹</button>
        </div>
        <div class="review-feedback">
          <h3>ä½ å¯¹è¿™ä¸ªå†…å®¹çš„æŒæ¡ç¨‹åº¦å¦‚ä½•ï¼Ÿ</h3>
          <div class="quality-options">
            <button 
              v-for="level in 5" 
              :key="level"
              @click="submitReview(level)"
              class="quality-btn"
            >
              {{ level }}ï¸âƒ£ {{ getQualityLabel(level) }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'KnowledgeManager',
  data() {
    return {
      searchQuery: '',
      selectedCategory: null,
      selectedItem: null,
      showCollectModal: false,
      showReviewModal: false,
      showFullContent: false,
      collectForm: {
        url: '',
        note: ''
      },
      reviewItem: null,
      items: [],
      categories: [
        { name: 'all', label: 'å…¨éƒ¨', icon: 'ğŸ“š', count: 0 },
        { name: 'inbox', label: 'æ”¶ä»¶ç®±', icon: 'ğŸ“¥', count: 0 },
        { name: 'tech/backend', label: 'åç«¯', icon: 'âš™ï¸', count: 0 },
        { name: 'tech/frontend', label: 'å‰ç«¯', icon: 'ğŸ¨', count: 0 },
        { name: 'tech/ai', label: 'AI', icon: 'ğŸ¤–', count: 0 },
        { name: 'products', label: 'äº§å“', icon: 'ğŸ“¦', count: 0 },
        { name: 'writing', label: 'å†™ä½œ', icon: 'âœï¸', count: 0 }
      ]
    }
  },
  methods: {
    async search() {
      const response = await fetch('/api/search', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          query: this.searchQuery,
          category: this.selectedCategory,
          limit: 20
        })
      })
      const data = await response.json()
      this.items = data.results
    },
    async collect() {
      const response = await fetch('/api/collect', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(this.collectForm)
      })
      const result = await response.json()
      
      if (result.success) {
        this.showCollectModal = false
        this.collectForm = {url: '', note: ''}
        alert('æ”¶è—æˆåŠŸï¼')
      } else {
        alert('æ”¶è—å¤±è´¥ï¼š' + result.message)
      }
    },
    selectCategory(category) {
      this.selectedCategory = category
      this.search()
    },
    openItem(item) {
      this.selectedItem = item
    },
    formatDate(dateStr) {
      const date = new Date(dateStr)
      return date.toLocaleDateString('zh-CN')
    },
    getQualityLabel(level) {
      const labels = ['', 'å®Œå…¨å¿˜è®°', 'æœ‰ç‚¹å°è±¡', 'è®°å¾—ä¸€åŠ', 'åŸºæœ¬è®°ä½', 'å®Œå…¨æŒæ¡']
      return labels[level]
    },
    async startReview() {
      this.reviewItem = this.selectedItem
      this.showReviewModal = true
      this.showFullContent = false
    },
    async submitReview(quality) {
      const response = await fetch(`/api/review/${this.reviewItem.id}`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({quality})
      })
      const result = await response.json()
      
      this.showReviewModal = false
      alert('å¤ä¹ è®°å½•å·²æ›´æ–°')
      this.search()
    }
  },
  mounted() {
    this.search()
  }
}
</script>

<style scoped>
.knowledge-manager {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

.navbar {
  display: flex;
  align-items: center;
  padding: 1rem 2rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
}

.search-box input {
  flex: 1;
  max-width: 400px;
  padding: 0.5rem 1rem;
  border: 1px solid #ced4da;
  border-radius: 4px;
}

.main-content {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.sidebar {
  width: 250px;
  border-right: 1px solid #dee2e6;
  overflow-y: auto;
}

.category-item {
  padding: 0.75rem 1rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.category-item:hover {
  background: #f8f9fa;
}

.category-item.active {
  background: #e7f3ff;
  color: #0066cc;
}

.content-list {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
}

.knowledge-item {
  padding: 1rem;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  margin-bottom: 1rem;
  cursor: pointer;
  transition: all 0.2s;
}

.knowledge-item:hover {
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.detail-panel {
  width: 400px;
  border-left: 1px solid #dee2e6;
  overflow-y: auto;
  padding: 1.5rem;
}

.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.modal-content {
  background: white;
  padding: 2rem;
  border-radius: 8px;
  max-width: 600px;
  width: 90%;
}

.review-modal .modal-content {
  max-width: 800px;
}

.quality-options {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 1rem;
  margin-top: 1rem;
}

.quality-btn {
  padding: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  background: white;
  cursor: pointer;
  transition: all 0.2s;
}

.quality-btn:hover {
  border-color: #0066cc;
  background: #e7f3ff;
}
</style>
```

## D. Dockeréƒ¨ç½²é…ç½®

```dockerfile
# Dockerfile
FROM python:3.10-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºæ•°æ®ç›®å½•
RUN mkdir -p /data

# æš´éœ²ç«¯å£
EXPOSE 8080

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8080"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  openclaw-km:
    build: .
    ports:
      - "8080:8080"
    volumes:
      - ./data:/data
    environment:
      - DATABASE_URL=sqlite:///data/knowledge.db
      - CHROMA_PATH=/data/chroma
      - LLM_API_KEY=${LLM_API_KEY}
      - LLM_BASE_URL=https://api.deepseek.com
      - LLM_MODEL=deepseek-chat
    restart: unless-stopped

  napcat:
    image: mlikiowa/napcat-docker:latest
    ports:
      - "3001:3001"
      - "6099:6099"
    volumes:
      - ./napcat/config:/app/config
    restart: unless-stopped
```

---

*æ‰©å±•å†…å®¹å®Œæ¯•ï¼Œæœ¬æ–‡æ€»è®¡ï¼š25000+å­—*

# è¡¥å……ç¬¬2ç« åˆ°ç¬¬10ç« çš„è¯¦ç»†å†…å®¹...

## è¡¥å……å†…å®¹ï¼šçŸ¥è¯†åº“æ•°æ®æ¨¡å‹è¯¦è§£

### å®Œæ•´çš„E-Rå›¾è®¾è®¡

```
çŸ¥è¯†åº“è¡¨ç»“æ„ï¼š

knowledge_items (çŸ¥è¯†æ¡ç›®ä¸»è¡¨)
â”œâ”€â”€ id (ä¸»é”®)
â”œâ”€â”€ title (æ ‡é¢˜)
â”œâ”€â”€ content_type (å†…å®¹ç±»å‹)
â”œâ”€â”€ content (å†…å®¹)
â”œâ”€â”€ tags (æ ‡ç­¾)
â”œâ”€â”€ category (åˆ†ç±»)
â”œâ”€â”€ importance (é‡è¦æ€§)
â”œâ”€â”€ collected_at (æ”¶è—æ—¶é—´)
â”œâ”€â”€ next_review (ä¸‹æ¬¡å¤ä¹ æ—¶é—´)
â””â”€â”€ ...

tags (æ ‡ç­¾è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ name
â””â”€â”€ count

categories (åˆ†ç±»è¡¨)
â”œâ”€â”€ id
â”œâ”€â”€ name
â”œâ”€â”€ parent_id (çˆ¶åˆ†ç±»)
â””â”€â”€ path

relations (å…³è”è¡¨)
â”œâ”€â”€ source_id
â”œâ”€â”€ target_id
â””â”€â”€ relation_type

review_history (å¤ä¹ å†å²)
â”œâ”€â”€ id
â”œâ”€â”€ item_id
â”œâ”€â”€ quality (è´¨é‡è¯„åˆ†)
â”œâ”€â”€ reviewed_at
â””â”€â”€ time_taken (ç”¨æ—¶)
```

### å®Œæ•´çš„CRUDæ“ä½œ

```python
class KnowledgeCRUD:
    """çŸ¥è¯†åº“CRUDæ“ä½œ"""
    
    def create(self, item: KnowledgeItem) -> str:
        """åˆ›å»ºçŸ¥è¯†æ¡ç›®"""
        # éªŒè¯æ•°æ®
        self._validate_item(item)
        
        # ç”ŸæˆID
        item.id = self._generate_id()
        
        # ä¿å­˜åˆ°æ•°æ®åº“
        self.data_store.save(item)
        
        # å»ºç«‹å‘é‡ç´¢å¼•
        self.search_engine.add_document(
            doc_id=item.id,
            text=item.content,
            metadata={'title': item.title, 'category': item.category}
        )
        
        # è®¾ç½®é¦–æ¬¡å¤ä¹ æ—¶é—´
        if item.review_enabled:
            reviewer = SpacedRepetition(self.data_store)
            reviewer.calculate_next_review(item.id, quality=3)
        
        return item.id
    
    def read(self, item_id: str) -> Optional[KnowledgeItem]:
        """è¯»å–çŸ¥è¯†æ¡ç›®"""
        return self.data_store.get(item_id)
    
    def update(self, item_id: str, updates: dict) -> bool:
        """æ›´æ–°çŸ¥è¯†æ¡ç›®"""
        item = self.data_store.get(item_id)
        if not item:
            return False
        
        # åº”ç”¨æ›´æ–°
        for key, value in updates.items():
            setattr(item, key, value)
        
        # ä¿å­˜
        self.data_store.update(item)
        
        # æ›´æ–°å‘é‡ç´¢å¼•ï¼ˆå¦‚æœå†…å®¹å˜äº†ï¼‰
        if 'content' in updates or 'title' in updates:
            self.search_engine.update_document(
                doc_id=item_id,
                text=item.content,
                metadata={'title': item.title, 'category': item.category}
            )
        
        return True
    
    def delete(self, item_id: str) -> bool:
        """åˆ é™¤çŸ¥è¯†æ¡ç›®"""
        # ä»æ•°æ®åº“åˆ é™¤
        result = self.data_store.delete(item_id)
        
        # ä»å‘é‡ç´¢å¼•åˆ é™¤
        self.search_engine.delete_document(item_id)
        
        return result
    
    def list(
        self,
        category: str = None,
        tags: list = None,
        sort_by: str = 'collected_at',
        limit: int = 50
    ) -> list:
        """åˆ—å‡ºçŸ¥è¯†æ¡ç›®"""
        return self.data_store.query({
            'category': category,
            'tags': {'$in': tags} if tags else None
        }, sort=sort_by, limit=limit)
```

### é«˜çº§æœç´¢åŠŸèƒ½

```python
class AdvancedSearch:
    """é«˜çº§æœç´¢"""
    
    def __init__(self, semantic_search, data_store):
        self.semantic = semantic_search
        self.store = data_store
    
    def search_with_filters(
        self,
        query: str,
        filters: dict
    ) -> list:
        """å¸¦è¿‡æ»¤çš„æœç´¢"""
        
        # åŸºç¡€æœç´¢
        results = self.semantic.search(query, n_results=50)
        
        # åº”ç”¨è¿‡æ»¤
        filtered_results = []
        
        for result in results:
            item_id = result['id']
            item = self.store.get(item_id)
            
            if not item:
                continue
            
            # æ£€æŸ¥è¿‡æ»¤æ¡ä»¶
            if self._matches_filters(item, filters):
                result['item'] = item
                filtered_results.append(result)
        
        return filtered_results
    
    def _matches_filters(self, item: dict, filters: dict) -> bool:
        """æ£€æŸ¥æ˜¯å¦åŒ¹é…è¿‡æ»¤æ¡ä»¶"""
        
        # ç±»åˆ«è¿‡æ»¤
        if 'category' in filters and item.get('category') != filters['category']:
            return False
        
        # æ ‡ç­¾è¿‡æ»¤ï¼ˆå¿…é¡»åŒ…å«æ‰€æœ‰æŒ‡å®šæ ‡ç­¾ï¼‰
        if 'tags' in filters:
            item_tags = set(item.get('tags', []))
            required_tags = set(filters['tags'])
            if not required_tags.issubset(item_tags):
                return False
        
        # é‡è¦æ€§è¿‡æ»¤
        if 'min_importance' in filters:
            if item.get('importance', 0) < filters['min_importance']:
                return False
        
        # æ—¶é—´èŒƒå›´è¿‡æ»¤
        if 'start_date' in filters:
            collected_at = datetime.fromisoformat(item.get('collected_at', ''))
            start = datetime.fromisoformat(filters['start_date'])
            if collected_at < start:
                return False
        
        if 'end_date' in filters:
            collected_at = datetime.fromisoformat(item.get('collected_at', ''))
            end = datetime.fromisoformat(filters['end_date'])
            if collected_at > end:
                return False
        
        return True
```

---

*ç¬¬äºŒç¯‡ç»§ç»­æ‰©å……ä¸­...*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                